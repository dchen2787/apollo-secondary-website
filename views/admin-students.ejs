<%- include("./partials/header"); -%>
<div class="container">
  <a class="btn btn-link" href="/admin/students">‚Üê Back to Students</a>

  <div class="d-flex align-items-center mb-3">
    <h1 class="h4 mb-0">
      <%= [student.fName, student.lName].filter(Boolean).join(' ') || student.email %>
    </h1>
    <% if (student.archived) { %><span class="badge badge-secondary ml-2">Archived</span><% } %>
    <span class="ml-3 text-muted"><%= student.email %></span>
  </div>

  <div class="card card-body mb-3">
    <form method="post" action="/admin/student/archive" style="display:inline;">
      <input type="hidden" name="email" value="<%= student.email %>">
      <input type="hidden" name="action" value="<%= student.archived ? 'unarchive' : 'archive' %>">
      <button class="btn <%= student.archived ? 'btn-success' : 'btn-warning' %>">
        <%= student.archived ? 'Unarchive' : 'Archive' %>
      </button>
    </form>
  </div>

  <div class="card card-body">
    <h5 class="mb-3">All Matches</h5>
    <div class="table-responsive">
      <table class="table table-sm">
        <thead><tr>
          <th>Date</th><th>Start</th><th>End</th><th>Physician</th><th>Specialty</th><th>Location</th><th></th>
        </tr></thead>
        <tbody>
          <% (slots || []).forEach(function(s){ %>
            <tr class="<%= s.isPast ? 'text-muted' : '' %>">
              <td><%= s.dDate || '' %></td>
              <td><%= s.timeStart || '' %></td>
              <td><%= s.timeEnd || '' %></td>
              <td><%= s.physName || '' %></td>
              <td><%= s.physSpecialty || '' %></td>
              <td><%= s.location || '' %></td>
              <td class="text-right">
                <form method="post" action="/admin/student/remove-slot" onsubmit="return confirm('Remove this slot?')" style="display:inline;">
                  <input type="hidden" name="slotId" value="<%= s._id %>">
                  <input type="hidden" name="email" value="<%= student.email %>">
                  <button class="btn btn-sm btn-outline-danger">Remove</button>
                </form>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</div>
<%- include("./partials/footer"); -%>
